import{r as c,j as e,A as S,m as w,e as P}from"./index-Bv38zTD5.js";import{u as E,I as m}from"./Input-BQFzFWOI.js";import{u as B,c as C}from"./blogService-D7q0Qi-R.js";import{u as T}from"./uploadService-Lp1vryN6.js";import{T as x}from"./Textarea-BPgRjjRx.js";import{B as b}from"./Button-IVDWkd94.js";import{B as k}from"./constants-DAdbbRzX.js";const O=({post:l,onClose:o})=>{const[d,u]=c.useState(!1),[p,g]=c.useState(!1),[f,n]=c.useState(""),{register:t,handleSubmit:j,formState:{errors:i},setValue:y,watch:v}=E({defaultValues:l||{title:"",excerpt:"",content:"",featuredImage:"",category:"Tech",tags:"",published:!0}}),h=v("featuredImage");c.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const I=async a=>{const r=a.target.files[0];if(r)try{g(!0);const s=await T(r);y("featuredImage",s.url)}catch{alert("Failed to upload image")}finally{g(!1)}},N=async a=>{try{if(u(!0),n(""),!a.featuredImage){n("Please upload or provide a featured image");return}const r={...a,tags:a.tags.split(",").map(s=>s.trim()).filter(s=>s)};l?await B(l._id,r):await C(r),o()}catch(r){n(r.response?.data?.message||"Failed to save post")}finally{u(!1)}};return e.jsx(S,{children:e.jsx("div",{className:"modal-overlay",onClick:o,children:e.jsxs(w.div,{className:"blog-form-modal",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:l?"Edit Blog Post":"Create New Post"}),e.jsx("button",{onClick:o,className:"modal-close-btn",children:e.jsx(P,{size:20})})]}),e.jsxs("form",{onSubmit:j(N),className:"blog-form",children:[e.jsx(m,{label:"Title",name:"title",placeholder:"Getting Started with React Hooks",register:t,error:i.title,required:!0}),e.jsx(x,{label:"Excerpt",name:"excerpt",placeholder:"Short summary of your post...",rows:2,register:t,error:i.excerpt,required:!0}),e.jsx(x,{label:"Content",name:"content",placeholder:"Write your blog post content here...",rows:8,register:t,error:i.content,required:!0}),e.jsx(m,{label:"Tags (comma-separated)",name:"tags",placeholder:"React, JavaScript, Tutorial",register:t}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:I,disabled:p}),p&&e.jsx("p",{className:"uploading",children:"Uploading..."}),h&&e.jsx("img",{src:h,alt:"Preview",className:"image-preview"})]}),e.jsx(m,{label:"Featured Image URL (or upload above)",name:"featuredImage",placeholder:"https://...",register:t,error:i.featuredImage}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("select",{...t("category"),className:"form-select",children:k.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",...t("published")}),e.jsx("span",{children:"Publish immediately"})]})}),f&&e.jsx("p",{className:"error-text",children:f}),e.jsxs("div",{className:"form-actions",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:o,children:"Cancel"}),e.jsx(b,{type:"submit",variant:"primary",disabled:d,children:d?"Saving...":l?"Update Post":"Create Post"})]})]})]})})})};export{O as default};
